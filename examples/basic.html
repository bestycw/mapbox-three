<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapboxThree Basic Example</title>
    <script src='https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin: 0; }
        #map { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .control-panel {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 10px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            z-index: 1;
        }
        button {
            display: block;
            margin: 5px 0;
            padding: 8px 16px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            background: #4a90e2;
            color: white;
            transition: background 0.3s;
        }
        button:hover {
            background: #357abd;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="control-panel">
        <button onclick="addSphere()">Add Sphere</button>
        <button onclick="addBox()">Add Box</button>
        <button onclick="addLine()">Add Line</button>
        <button onclick="addTube()">Add Tube</button>
        <button onclick="toggleTerrain()">Toggle Terrain</button>
        <button onclick="changeCamera()">Change Camera</button>
        <button onclick="clearObjects()">Clear Objects</button>
    </div>

    <script type="module">
        import { MapboxThree } from '../src/core/index.ts';

        let mapboxThree;
        let terrainEnabled = false;
        const objects = [];

        // Initialize MapboxThree
        mapboxThree = new MapboxThree({
            mapboxConfig: {
                container: 'map',
                style: 'mapbox://styles/mapbox/dark-v11',
                accessToken: 'pk.eyJ1IjoiYmVzdHljdyIsImEiOiJja3Y2YW5icnQxaTltMnBsMGR2c2FmaDZmIn0.bYZIK1mPso12DuyirxXjVw', // Replace with your token
                center: [-74.5, 40],
                zoom: 9,
                pitch: 60,
                bearing: 30,
                antialias: true,
                terrain: {
                    source: 'mapbox://mapbox.mapbox-terrain-dem-v1',
                    exaggeration: 1.5
                }
            },
            defaultLights: true,
            passiveRendering: true,
            onLoad: () => {
                console.log('MapboxThree initialized successfully');
                // Add initial objects if needed
                addSphere();
            },
            onError: (error) => {
                console.error('MapboxThree error:', error);
            }
        });

        // Make functions globally available
        window.addSphere = () => {
            const sphere = mapboxThree.sphere({
                coordinates: [-74.5, 40],
                radius: 200,
                color: '#ff0000',
                opacity: 0.8,
                units: 'meters',
                altitude: 500
            });
            mapboxThree.add(sphere);
            objects.push(sphere);

            // Add animation
            mapboxThree.animate(sphere, {
                'position.y': { start: sphere.position.y, end: sphere.position.y + 1000 }
            }, {
                duration: 2000,
                easing: 'easeInOutQuad',
                yoyo: true,
                repeat: -1
            });
        };

        window.addBox = () => {
            const box = mapboxThree.box({
                coordinates: [-74.6, 40.1],
                width: 300,
                height: 300,
                depth: 300,
                color: '#00ff00',
                opacity: 0.8,
                units: 'meters',
                altitude: 300
            });
            mapboxThree.add(box);
            objects.push(box);

            // Add rotation animation
            mapboxThree.animate(box, {
                'rotation.y': { start: 0, end: Math.PI * 2 }
            }, {
                duration: 3000,
                repeat: -1
            });
        };

        window.addLine = () => {
            const line = mapboxThree.line({
                path: [
                    [-74.5, 40],
                    [-74.3, 40.2],
                    [-74.7, 40.4]
                ],
                width: 10,
                color: '#0000ff',
                units: 'meters',
                altitude: 200
            });
            mapboxThree.add(line);
            objects.push(line);
        };

        window.addTube = () => {
            const tube = mapboxThree.tube({
                path: [
                    [-74.5, 40],
                    [-74.3, 40.2],
                    [-74.7, 40.4]
                ],
                radius: 50,
                color: '#ffff00',
                opacity: 0.8,
                units: 'meters',
                altitude: 400,
                segments: 64,
                radialSegments: 8
            });
            mapboxThree.add(tube);
            objects.push(tube);
        };

        window.toggleTerrain = () => {
            terrainEnabled = !terrainEnabled;
            mapboxThree.setTerrain(terrainEnabled, 1.5);
        };

        window.changeCamera = () => {
            mapboxThree.setCamera({
                center: [-74.3, 40.2],
                zoom: 12,
                pitch: 75,
                bearing: 45
            });
        };

        window.clearObjects = () => {
            objects.forEach(obj => mapboxThree.remove(obj));
            objects.length = 0;
        };

        // Add click event listener
        mapboxThree.addEventListener(mapboxThree.world, 'click', (event) => {
            const { object, intersection } = event;
            if (object) {
                console.log('Clicked object:', {
                    object,
                    position: intersection.point,
                    distance: intersection.distance
                });
            }
        });
    </script>
</body>
</html> 